import{b9 as e,d as l,S as a,r as s,o as t,b8 as i,c,e as o,Y as n,w as r,l as d,g as m,t as u,Z as f,a1 as _,W as p,m as v,aQ as b,aH as y,ay as h,a0 as g}from"./index.V7TsgTEq.js";import{v as k}from"./el-loading.CUKFIxyY.js";import{_ as j}from"./index.DDhQ4iwa.js";import{E as x,a as w}from"./el-table-column.BFVhfB4m.js";import"./el-checkbox.CWpy68J6.js";import"./el-tooltip.l0sNRNKZ.js";import"./el-scrollbar.Dfe8YXkA.js";import{_ as C}from"./delete.BIGVJTzd.js";/* empty css               */import{E as S}from"./el-row.DBATjGvD.js";import{E as z}from"./el-col.BebB5Fab.js";import{E}from"./el-card.BJ4uZ2ka.js";import{i as O}from"./index.B6oudZUb.js";import"./el-select.C7IgsXi3.js";import"./index.CoRC1ks8.js";import"./strings.Bv4Mk_5L.js";import"./isEqual.D_Din47F.js";import"./_initCloneObject.BGweDbMt.js";import"./_baseIteratee.Br-040dN.js";import"./index.Dr-8d26T.js";import"./castArray.BrIbwm_9.js";import"./_plugin-vue_export-helper.BCo6x5W8.js";import"./isUndefined.DgmxjSXK.js";const U={class:"app-container"},F=d("span",null,"基本信息",-1),T={class:"el-table el-table--enable-row-hover el-table--medium"},N={cellspacing:"0",style:{width:"100%"}},P=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"Redis版本")],-1),R={class:"el-table__cell is-leaf"},A={key:0,class:"cell"},B=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"运行模式")],-1),D={class:"el-table__cell is-leaf"},I={key:0,class:"cell"},H=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"端口")],-1),V={class:"el-table__cell is-leaf"},W={key:0,class:"cell"},Y=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"客户端数")],-1),Z={class:"el-table__cell is-leaf"},q={key:0,class:"cell"},J=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"运行时间(天)")],-1),K={class:"el-table__cell is-leaf"},Q={key:0,class:"cell"},$=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"使用内存")],-1),G={class:"el-table__cell is-leaf"},L={key:0,class:"cell"},M=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"使用CPU")],-1),X={class:"el-table__cell is-leaf"},ee={key:0,class:"cell"},le=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"内存配置")],-1),ae={class:"el-table__cell is-leaf"},se={key:0,class:"cell"},te=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"AOF是否开启")],-1),ie={class:"el-table__cell is-leaf"},ce={key:0,class:"cell"},oe=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"RDB是否成功")],-1),ne={class:"el-table__cell is-leaf"},re={key:0,class:"cell"},de=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"Key数量")],-1),me={class:"el-table__cell is-leaf"},ue={key:0,class:"cell"},fe=d("td",{class:"el-table__cell is-leaf"},[d("div",{class:"cell"},"网络入口/出口")],-1),_e={class:"el-table__cell is-leaf"},pe={key:0,class:"cell"},ve={key:0},be=["onClick"],ye=l({name:"Cache",inheritAttrs:!1,__name:"cache",setup(l){const ye=a({pageNo:1,pageSize:10}),he=s(!1),ge=s(),ke=s(),je=s({}),xe=s([]),we=s(0),Ce=s(),Se=s();function ze(){he.value=!0,function(l){return e({url:"/system/cache/list",method:"get",params:l})}(ye).then((({data:e})=>{xe.value=e.records,we.value=e.total})).finally((()=>{he.value=!1}))}function Ee(l){var a;he.value=!0,(a=l.key,e({url:"/system/cache/getValue/"+a,method:"get"})).then((({data:e})=>{l.value=e})).finally((()=>{he.value=!1}))}function Oe(l){y.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{he.value=!0,function(l){return e({url:"/system/cache/delete/"+l,method:"delete"})}(l).then((()=>{h.success("删除成功"),ze()})).finally((()=>he.value=!1))}))}function Ue(){e({url:"/system/cache/getCacheInfo",method:"get"}).then((e=>{je.value=e.data,ge.value=O(Ce.value,"macarons"),ge.value.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:"命令",type:"pie",roseType:"radius",radius:[15,95],center:["50%","38%"],data:e.data.commandStats,animationEasing:"cubicInOut",animationDuration:1e3}]}),ke.value=O(Se.value,"macarons"),ke.value.setOption({tooltip:{formatter:"{b} <br/>{a} : "+je.value.info.used_memory_human},series:[{name:"峰值",type:"gauge",min:0,max:1e3,detail:{formatter:je.value.info.used_memory_human},data:[{value:parseFloat(je.value.info.used_memory_human),name:"内存消耗"}]}]})}))}return t((()=>{ze(),Ue()})),(e,l)=>{const a=E,s=z,t=S,y=x,h=C,O=g,ge=w,ke=j,Ce=i("hasPerm"),Se=k;return c(),o("div",U,[n(t,null,{default:r((()=>[n(s,{span:24,class:"card-box"},{default:r((()=>[n(a,{style:{"margin-bottom":"10px"}},{header:r((()=>[F])),default:r((()=>[d("div",T,[d("table",N,[d("tbody",null,[d("tr",null,[P,d("td",R,[m(je).info?(c(),o("div",A,u(m(je).info.redis_version),1)):f("",!0)]),B,d("td",D,[m(je).info?(c(),o("div",I,u("standalone"==m(je).info.redis_mode?"单机":"集群"),1)):f("",!0)]),H,d("td",V,[m(je).info?(c(),o("div",W,u(m(je).info.tcp_port),1)):f("",!0)]),Y,d("td",Z,[m(je).info?(c(),o("div",q,u(m(je).info.connected_clients),1)):f("",!0)])]),d("tr",null,[J,d("td",K,[m(je).info?(c(),o("div",Q,u(m(je).info.uptime_in_days),1)):f("",!0)]),$,d("td",G,[m(je).info?(c(),o("div",L,u(m(je).info.used_memory_human),1)):f("",!0)]),M,d("td",X,[m(je).info?(c(),o("div",ee,u(parseFloat(m(je).info.used_cpu_user_children).toFixed(2)),1)):f("",!0)]),le,d("td",ae,[m(je).info?(c(),o("div",se,u(m(je).info.maxmemory_human),1)):f("",!0)])]),d("tr",null,[te,d("td",ie,[m(je).info?(c(),o("div",ce,u("0"==m(je).info.aof_enabled?"否":"是"),1)):f("",!0)]),oe,d("td",ne,[m(je).info?(c(),o("div",re,u(m(je).info.rdb_last_bgsave_status),1)):f("",!0)]),de,d("td",me,[m(je).dbSize?(c(),o("div",ue,u(m(je).dbSize),1)):f("",!0)]),fe,d("td",_e,[m(je).info?(c(),o("div",pe,u(m(je).info.instantaneous_input_kbps)+"kps/"+u(m(je).info.instantaneous_output_kbps)+"kps ",1)):f("",!0)])])])])])])),_:1})])),_:1})])),_:1}),n(a,{shadow:"never",class:"table-container"},{header:r((()=>[_("数据列表")])),default:r((()=>[p((c(),v(ge,{ref:"dataTableRef",data:m(xe),"highlight-current-row":"",stripe:"",fit:"","max-height":"600px"},{default:r((()=>[n(y,{label:"键",align:"center",prop:"key"}),n(y,{label:"值",align:"center",prop:"value","show-overflow-tooltip":!0},{default:r((e=>[e.row.value?(c(),o("div",ve,u(e.row.value),1)):(c(),o("div",{key:1,class:"not-show",onClick:l=>Ee(e.row)}," 点击加载 ",8,be))])),_:1}),n(y,{fixed:"right",align:"center",label:"操作",width:"220"},{default:r((e=>[p((c(),v(O,{type:"danger",size:"small",link:"",onClick:l=>Oe(e.row.key)},{default:r((()=>[n(h),_("删除 ")])),_:2},1032,["onClick"])),[[Ce,["system:cache:delete"]]])])),_:1})])),_:1},8,["data"])),[[Se,m(he)]]),m(we)>0?(c(),v(ke,{key:0,total:m(we),"onUpdate:total":l[0]||(l[0]=e=>b(we)?we.value=e:null),page:m(ye).pageNo,"onUpdate:page":l[1]||(l[1]=e=>m(ye).pageNo=e),limit:m(ye).pageSize,"onUpdate:limit":l[2]||(l[2]=e=>m(ye).pageSize=e),onPagination:ze},null,8,["total","page","limit"])):f("",!0)])),_:1})])}}});export{ye as default};
